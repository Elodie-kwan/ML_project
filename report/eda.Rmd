
```{r, echo = FALSE, message = FALSE}
source(here::here("scripts/setup.R"))
```

Let's import the cleaned dataset that we created. 

```{r}
Mountain_data_cleaned <- read.csv("../data/Mountain_data_cleaned.csv")
str(Mountain_data_cleaned)
```

We have to transform the class of the variables **Country**, **Mountain_Range**, **Locality**, **Plot** and **Subplot** because they are categorical variables. So we will transform them as factors. 

```{r}
Mountain_data_cleaned$Country <- as.factor(Mountain_data_cleaned$Country)
Mountain_data_cleaned$Mountain_range <- as.factor(Mountain_data_cleaned$Mountain_range)
Mountain_data_cleaned$Locality <- as.factor(Mountain_data_cleaned$Locality)
Mountain_data_cleaned$Plot <- as.factor(Mountain_data_cleaned$Plot)
Mountain_data_cleaned$Subplot <- as.factor(Mountain_data_cleaned$Subplot)

Mountain_data_cleaned$Date <- as.Date(Mountain_data_cleaned$Date, "%d/%m/%Y")

```


```{r}
dfSummary(Mountain_data_cleaned, style="grid")
```

```{r}
which(is.na(Mountain_data_cleaned))
```

```{r}
describe(Mountain_data_cleaned)
introduce(Mountain_data_cleaned)
plot_intro(Mountain_data_cleaned)
```


```{r}
plot_histogram(Mountain_data)
plot_density(Mountain_data)
```
Many variables appear with a distribution that looks like the log-normal distribution.


```{r}
plot_boxplot(Mountain_data, by = 'Mountain_range',  ncol = 2,
             title = "Side-by-side boxplots")
```
Can see the real differences between the mountains. (Comment more + comment outliers)


```{r}
ggplot(Mountain_data) + geom_bar(aes(x = Mountain_range))
```
Can comment on the number of different observations and the affect on accuracy. Can focus more on sensibility and sensitivy if needed because indeed there is twice more informations on Sierra de Guadarrama.

Correlation plot between continuous variables : 
```{r}
plot_correlation(Mountain_data, type= 'c', cor_args = list( 'use' = 'complete.obs'))
```
Make a regression Mountain_range ~ ... to see the relevant variables 
+
Make a PCA


PCA exploration

- Selecct only the numerical values:

```{r}
Mountain_data.num <- select_if(Mountain_data, is.numeric)
to.delet <- c('Day', 'Month', 'Year')
Mountain_data.num <- select(Mountain_data.num, -to.delet)

```


```{r}
library(FactoMineR)
library(factoextra)
```

```{r}
Mountain_data.pca <- prcomp(Mountain_data.num, center = TRUE)
summary(Mountain_data.pca)
```
Je comprend pas pourquoi il y a une erreur ici...

```{r}
resultats_pca <- PCA(Mountain_data.num, scale.unit = TRUE, ncp = 5, graph = FALSE)
```

```{r}
eig.val <- get_eigenvalue(resultats_pca)
eig.val
```

```{r}
fviz_eig(resultats_pca, addlabels = TRUE)
```

```{r}
fviz_pca_var(resultats_pca)
```

```{r}
var <- get_pca_var(resultats_pca)
var
```

```{r}
library(corrplot)
corrplot(var$cos2, is.corr = FALSE)
```

```{r}
fviz_pca_ind(resultats_pca)
```


```{r}
fviz_pca_biplot(resultats_pca, repel = TRUE,
                col.var = "blue", # Couleur des variables
                col.ind = "red"  # Couleur des individues
                )
```


